{{!
    @template theme_cmagistratura/block_timeline/event-list-item

    Refactored event list item for Gantt-style visualization.
}}
<div class="list-group-item timeline-event-list-item flex-column py-3 border-0 shadow-sm mb-2 {{#courseview}}px-0{{/courseview}}{{^courseview}}px-3{{/courseview}}"
        data-region="event-list-item"
        style="border-left: 4px solid #ffc107; border-radius: 4px;">
    <div class="d-flex flex-wrap align-items-center">
        <div class="d-flex mr-auto mw-100 timeline-name align-items-center">
            <div class="date-container mr-3 text-center" style="min-width: 60px;">
                <div class="small text-muted font-weight-bold" style="line-height: 1.2;">
                    {{#userdate}} {{timesort}}, %d {{/userdate}}
                </div>
                <div class="text-uppercase small" style="font-size: 0.7rem;">
                    {{#userdate}} {{timesort}}, %b {{/userdate}}
                </div>
            </div>
            
            <div class="activityiconcontainer small {{purpose}} courseicon mr-3">
                {{#icon}}
                {{#iconurl}}
                    <img alt="{{alttext}}" title="{{alttext}}" src="{{{ iconurl }}}" class="icon {{iconclass}}">
                {{/iconurl}}
                {{^iconurl}}
                    {{#pix}} {{key}}, {{component}}, {{alttext}} {{/pix}}
                {{/iconurl}}
                {{/icon}}
            </div>

            <div class="event-name-container flex-grow-1 line-height-3 nowrap text-truncate">
                <h6 class="event-name mb-0 font-weight-bold text-truncate">
                    {{#overdue}}<span class="badge badge-pill badge-danger ml-1 float-right">{{#str}} overdue, block_timeline {{/str}}</span>{{/overdue}}
                    <a href="{{url}}" class="text-dark"
                            title="{{name}}"
                            aria-label='{{#cleanstr}} ariaeventlistitem, block_timeline, { "name": {{#quote}}{{{activityname}}}{{/quote}}, "course": {{#quote}}{{{course.fullnamedisplay}}}{{/quote}}, "date": "{{#userdate}} {{timesort}}, {{#str}} strftimedatetime, core_langconfig {{/str}} {{/userdate}}" } {{/cleanstr}}'>
                        {{{activityname}}}</a>
                </h6>
                <small class="text-muted d-block">
                    {{#courseview}}
                        {{activitystr}}
                    {{/courseview}}
                    {{^courseview}}
                        {{activitystr}}{{#course.fullnamedisplay}} &middot; <span class="text-primary">{{{course.fullnamedisplay}}}</span>{{/course.fullnamedisplay}}
                    {{/courseview}}
                </small>
            </div>
        </div>
        
        {{#action.actionable}}
        <div class="d-flex timeline-action-button ml-3">
            <a class="btn btn-primary btn-sm text-nowrap shadow-sm"
                href="{{action.url}}"
                aria-label="{{action.name}}"
                title="{{action.name}}">
            {{{action.name}}}
            {{#action.showitemcount}}
            <span class="badge badge-light ml-1">{{action.itemcount}}</span>
            {{/action.showitemcount}}
            </a>
        </div>
        {{/action.actionable}}
    </div>
</div>